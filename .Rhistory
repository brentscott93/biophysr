wt_before %<>% mutate(avg = avg-wt_baseline_avg)
ggplot()+
geom_point(data = wt_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = wt_avg_line,
aes(x = time,
y = y),
color = "blue",
size = 1.5)+
geom_point(data = wt_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = wt_df$avg[[1]]),
color = "blue",
size = 5,
shape = 1,
alpha = 0.8)+
scale_y_continuous(limits = c(-2, 8), breaks = seq(-2, 8, by = 2))+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-WT Ensemble Average")+
theme_classic(base_size = 16)
# geom_table_npc(data = wt_tb, aes(npcx = x, npcy = y, label = tb), size = 6)+
# annotate('text', x = 0.04, y = 2,
# label = "y==alpha*(1-e^{(-c*X)})",parse = TRUE,size=10)
wt_avg_line <- data.frame(time = seq(0, 0.06, by = 0.0001))
wt_avg_line %<>% mutate(y = predict(wt_drm_negExp, newdata = wt_avg_line))
class(wt_drm_negExp) <- append(class(wt_drm_negExp),"nls")
wt_table <- tidy(wt_drm_negExp) %>%
mutate_if(is.numeric, round, digits = 1)
wt_tb <- tibble(x = 0.95, y = 0.05, tb = list(wt_table))
wt_before <- wt_forward_avg %>%
filter(forward_index >= -150, forward_index < 0) %>%
mutate(time = seq(-0.03, -0.0002, by = 0.0002))
wt_baseline_avg <- wt_before %>%
summarize(mean = mean(avg)) %>%
pull(mean) %>%
as.numeric
wt_before %<>% mutate(avg = avg-wt_baseline_avg)
ggplot()+
geom_point(data = wt_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = wt_avg_line,
aes(x = time,
y = y),
color = "blue",
size = 1.5)+
geom_point(data = wt_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = wt_df$avg[[1]]),
color = "blue",
size = 5,
shape = 1,
alpha = 0.8)+
scale_y_continuous(limits = c(-2.5, 8), breaks = seq(-2, 8, by = 2))+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-WT Ensemble Average")+
theme_classic(base_size = 16)
# geom_table_npc(data = wt_tb, aes(npcx = x, npcy = y, label = tb), size = 6)+
# annotate('text', x = 0.04, y = 2,
# label = "y==alpha*(1-e^{(-c*X)})",parse = TRUE,size=10)
mut_files <- list_files("/Users/brentscott/Box Sync/Muscle Biophysics Lab/Data/biophysr/bscott/trap/project_myoV/myoV-S217A_pH7.0_1stControl",
recursive = T,
pattern = "forward_ensemble")
mut_data <-bind_rows(map(mut_files$path, read_csv))
mut_forward_avg <- mut_data %>%
dplyr::filter(is_positive == T) %>%
group_by(forward_index) %>%
summarize(avg = mean(data, na.rm = T),
n = dplyr::n())
mut_zero <- mut_forward_avg %>%
filter(forward_index == 0) %>%
pull(avg)
mut_df <- filter(mut_forward_avg, forward_index >= 0) %>%
rownames_to_column(var = "new_x") %>%
mutate(time = as.numeric(new_x)/5000,
avg = avg - mut_zero)
mut_drm_negExp <- drm(avg ~ time, data = mut_df, fct = DRC.negExp())
summary(mut_drm_negExp)
mut_avg_line <- data.frame(time = seq(0, 0.06, by = 0.0001))
mut_avg_line %<>% mutate(y = predict(mut_drm_negExp, newdata = mut_avg_line))
class(mut_drm_negExp) <- append(class(mut_drm_negExp),"nls")
mut_table <- tidy(mut_drm_negExp) %>%
mutate_if(is.numeric, round, digits = 1)
mut_tb <- tibble(x = 0.95, y = 0.05, tb = list(mut_table))
mut_before <- mut_forward_avg %>%
filter(forward_index >= -150, forward_index < 0) %>%
mutate(time = seq(-0.03, -0.0002, by = 0.0002))
mut_baseline_avg <- mut_before %>%
summarize(mean = mean(avg)) %>%
pull(mean) %>%
as.numeric
mut_before %<>% mutate(avg = avg-mut_baseline_avg)
ggplot()+
geom_point(data = mut_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = mut_avg_line,
aes(x = time,
y = y),
color = "red",
size = 1.5)+
geom_point(data = mut_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = mut_df$avg[[1]]),
color = "red",
size = 5,
shape = 1,
alpha = 0.8)+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-S217A Ensemble Average")+
scale_y_continuous(breaks = seq(-2.5, 8, by = 2))+
theme_classic(base_size = 16)
# geom_table_npc(data = mut_tb, aes(npcx = x, npcy = y, label = tb), size = 6)+
#annotate('text', x = 0.04, y = 2.7,
#     label = "y==alpha*(1-e^{(-c*X)})",parse = TRUE,size=10)
mut_avg_line <- data.frame(time = seq(0, 0.06, by = 0.0001))
mut_avg_line %<>% mutate(y = predict(mut_drm_negExp, newdata = mut_avg_line))
class(mut_drm_negExp) <- append(class(mut_drm_negExp),"nls")
mut_table <- tidy(mut_drm_negExp) %>%
mutate_if(is.numeric, round, digits = 1)
mut_tb <- tibble(x = 0.95, y = 0.05, tb = list(mut_table))
mut_before <- mut_forward_avg %>%
filter(forward_index >= -150, forward_index < 0) %>%
mutate(time = seq(-0.03, -0.0002, by = 0.0002))
mut_baseline_avg <- mut_before %>%
summarize(mean = mean(avg)) %>%
pull(mean) %>%
as.numeric
mut_before %<>% mutate(avg = avg-mut_baseline_avg)
ggplot()+
geom_point(data = mut_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = mut_avg_line,
aes(x = time,
y = y),
color = "red",
size = 1.5)+
geom_point(data = mut_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = mut_df$avg[[1]]),
color = "red",
size = 5,
shape = 1,
alpha = 0.8)+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-S217A Ensemble Average")+
scale_y_continuous(limits = c(2.5, 8),breaks = seq(-2, 8, by = 2))+
theme_classic(base_size = 16)
# geom_table_npc(data = mut_tb, aes(npcx = x, npcy = y, label = tb), size = 6)+
#annotate('text', x = 0.04, y = 2.7,
#     label = "y==alpha*(1-e^{(-c*X)})",parse = TRUE,size=10)
mut_avg_line <- data.frame(time = seq(0, 0.06, by = 0.0001))
mut_avg_line %<>% mutate(y = predict(mut_drm_negExp, newdata = mut_avg_line))
class(mut_drm_negExp) <- append(class(mut_drm_negExp),"nls")
mut_table <- tidy(mut_drm_negExp) %>%
mutate_if(is.numeric, round, digits = 1)
mut_tb <- tibble(x = 0.95, y = 0.05, tb = list(mut_table))
mut_before <- mut_forward_avg %>%
filter(forward_index >= -150, forward_index < 0) %>%
mutate(time = seq(-0.03, -0.0002, by = 0.0002))
mut_baseline_avg <- mut_before %>%
summarize(mean = mean(avg)) %>%
pull(mean) %>%
as.numeric
mut_before %<>% mutate(avg = avg-mut_baseline_avg)
ggplot()+
geom_point(data = mut_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = mut_avg_line,
aes(x = time,
y = y),
color = "red",
size = 1.5)+
geom_point(data = mut_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = mut_df$avg[[1]]),
color = "red",
size = 5,
shape = 1,
alpha = 0.8)+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-S217A Ensemble Average")+
scale_y_continuous(limits = c(-2.5, 8),breaks = seq(-2, 8, by = 2))+
theme_classic(base_size = 16)
# geom_table_npc(data = mut_tb, aes(npcx = x, npcy = y, label = tb), size = 6)+
#annotate('text', x = 0.04, y = 2.7,
#     label = "y==alpha*(1-e^{(-c*X)})",parse = TRUE,size=10)
mut_avg_line <- data.frame(time = seq(0, 0.06, by = 0.0001))
mut_avg_line %<>% mutate(y = predict(mut_drm_negExp, newdata = mut_avg_line))
class(mut_drm_negExp) <- append(class(mut_drm_negExp),"nls")
mut_table <- tidy(mut_drm_negExp) %>%
mutate_if(is.numeric, round, digits = 1)
mut_tb <- tibble(x = 0.95, y = 0.05, tb = list(mut_table))
mut_before <- mut_forward_avg %>%
filter(forward_index >= -150, forward_index < 0) %>%
mutate(time = seq(-0.03, -0.0002, by = 0.0002))
mut_baseline_avg <- mut_before %>%
summarize(mean = mean(avg)) %>%
pull(mean) %>%
as.numeric
mut_before %<>% mutate(avg = avg-mut_baseline_avg)
ggplot()+
geom_point(data = mut_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = mut_avg_line,
aes(x = time,
y = y),
color = "red",
size = 1.5)+
geom_point(data = mut_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = mut_df$avg[[1]]),
color = "red",
size = 5,
shape = 1,
alpha = 0.8)+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-S217A Ensemble Average")+
scale_y_continuous(limits = c(-2.5, 8),breaks = seq(-2, 8, by = 2))+
theme_classic(base_size = 16)
# geom_table_npc(data = mut_tb, aes(npcx = x, npcy = y, label = tb), size = 6)+
#annotate('text', x = 0.04, y = 2.7,
#     label = "y==alpha*(1-e^{(-c*X)})",parse = TRUE,size=10)
mut_avg_line <- data.frame(time = seq(0, 0.06, by = 0.0001))
mut_avg_line %<>% mutate(y = predict(mut_drm_negExp, newdata = mut_avg_line))
class(mut_drm_negExp) <- append(class(mut_drm_negExp),"nls")
mut_table <- tidy(mut_drm_negExp) %>%
mutate_if(is.numeric, round, digits = 1)
mut_tb <- tibble(x = 0.95, y = 0.05, tb = list(mut_table))
mut_before <- mut_forward_avg %>%
filter(forward_index >= -150, forward_index < 0) %>%
mutate(time = seq(-0.03, -0.0002, by = 0.0002))
mut_baseline_avg <- mut_before %>%
summarize(mean = mean(avg)) %>%
pull(mean) %>%
as.numeric
mut_before %<>% mutate(avg = avg-mut_baseline_avg)
ggplot()+
geom_point(data = mut_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = mut_avg_line,
aes(x = time,
y = y),
color = "red",
size = 1.5)+
geom_point(data = mut_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = mut_df$avg[[1]]),
color = "red",
size = 5,
shape = 1,
alpha = 0.8)+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-S217A Ensemble Average")+
scale_y_continuous(limits = c(-2.7, 8),breaks = seq(-2, 8, by = 2))+
theme_classic(base_size = 16)
# geom_table_npc(data = mut_tb, aes(npcx = x, npcy = y, label = tb), size = 6)+
#annotate('text', x = 0.04, y = 2.7,
#     label = "y==alpha*(1-e^{(-c*X)})",parse = TRUE,size=10)
ggplot()+
geom_point(data = mut_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = mut_avg_line,
aes(x = time,
y = y),
color = "red",
size = 1.5)+
geom_point(data = mut_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = mut_df$avg[[1]]),
color = "red",
size = 5,
shape = 1,
alpha = 0.8)+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-S217A Ensemble Average")+
scale_y_continuous(limits = c(-3, 8),breaks = seq(-2, 8, by = 2))+
theme_classic(base_size = 16)
ggplot()+
geom_point(data = mut_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = mut_avg_line,
aes(x = time,
y = y),
color = "red",
size = 1.5)+
geom_point(data = mut_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = mut_df$avg[[1]]),
color = "red",
size = 5,
shape = 1,
alpha = 0.8)+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-S217A Ensemble Average")+
scale_y_continuous(limits = c(-3, 8.5),breaks = seq(-2, 8, by = 2))+
theme_classic(base_size = 16)
ggplot()+
geom_point(data = wt_df,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_line(data = wt_avg_line,
aes(x = time,
y = y),
color = "blue",
size = 1.5)+
geom_point(data = wt_before,
aes(x = time,
y = avg),
size = 5,
alpha = 0.5)+
geom_point(aes(x = 0.0002,
y = wt_df$avg[[1]]),
color = "blue",
size = 5,
shape = 1,
alpha = 0.8)+
scale_y_continuous(limits = c(-3, 8.5), breaks = seq(-2, 8, by = 2))+
ylab("Displacement (nm)")+
xlab("Time (sec)")+
ggtitle("myoV-WT Ensemble Average")+
theme_classic(base_size = 16)
wt_df %<>% mutate(conditions = "wt")
mut_df %<>% mutate(conditions = "mut")
all <- rbind(wt_df, mut_df)
all$conditions <- factor(all$conditions, levels = c("wt", "mut"))
all_drm <- drm(avg ~ time, curveid = conditions, data = all, fct = DRC.negExp())
compParm(all_drm, strVal = "a", operator = "-")
compParm(all_drm, strVal = "c", operator = "-")
trap_selected_project <- "/Users/brentscott/Box Sync/Muscle Biophysics Lab/Data/biophysr/bscott/trap/project_myoV-1stControlOnly"
directions <- list.files(path = trap_selected_project,
pattern = "directions.csv",
recursive = TRUE,
full.names = TRUE)
event_paths <- list.files(path = trap_selected_project,
pattern = "hmm_events.csv",
recursive = TRUE,
full.names = TRUE)
raw_data_paths <- list.files(path = trap_selected_project,
pattern = "grouped",
recursive = TRUE,
full.names = TRUE)
read_exported_directions <- suppressMessages(bind_rows(lapply(directions, read_csv))) %>%
mutate(grouped_file = raw_data_paths) %>%
filter(report == "success") %>%
mutate(event_paths = event_paths) %>%
rename("quality_control" = `Quality Control`) %>%
filter(quality_control == TRUE) %>%
mutate(groupedfile = grouped_file)
read_exported_directions %<>% separate(groupedfile, c("none", "user", "bs", "box", "mbl", "d", "bio", "bscott", "trap", "project", "conditions", "date", "obser", "filename"), sep = "/")
all_hmm_events <- suppressMessages(map(read_exported_directions$event_paths, read_csv, col_names = TRUE))
for(s in 1:nrow(read_exported_directions)){
all_hmm_events[[s]] <- cbind(all_hmm_events[[s]], read_exported_directions$conditions[[s]])
}
event_files_filtered <- bind_rows(all_hmm_events) %>%
rename(conditions = 'read_exported_directions$conditions[[s]]') #%>%
# separate(conditions, c("myo", "ph", "phosphate"), sep = "_")
dir.create(paste0(trap_selected_project, "/summary"))
write_csv(event_files_filtered, paste0(trap_selected_project, "/summary/all_hmm.csv"))
#####summarise
all_grouped <- suppressMessages(map(read_exported_directions$grouped_file, read_csv, col_names = FALSE))
for(g in 1:nrow(read_exported_directions)){
all_grouped[[g]] <- cbind(all_grouped[[g]], read_exported_directions$conditions[[g]])
}
all_grouped <- bind_rows(all_grouped) %>%
rename(conditions = 'read_exported_directions$conditions[[g]]')
get_time <- all_grouped %>%
group_by(conditions) %>%
summarize(minutes = round((length(X1)/5000)/60, 2)) #%>%
#separate(conditions, c("myo", "ph", "phosphate"), sep = "_")
num_events <- event_files_filtered %>%
group_by(conditions) %>%
count()
summarize_trap <- event_files_filtered %>%
group_by(conditions) %>%
summarize(time_on_avg = mean(time_on_ms),
time_on_sd = sd(time_on_ms, na.rm = TRUE),
time_off_avg = mean(time_off_ms, na.rm = TRUE),
time_off_sd = sd(time_off_ms, na.rm = TRUE),
displacement_avg = mean(displacement_nm, na.rm = TRUE),
displacement_sd = sd(displacement_nm, na.rm = TRUE),
force_avg = mean(force, na.rm = TRUE),
force_sd = sd(force, na.rm = TRUE),
num_events = n()) %>%
right_join(get_time) %>%
mutate(seconds = minutes*60,
events_per_sec = num_events/seconds) %>%
mutate_if(is.numeric, round, digits = 2) %>%
dplyr::select(conditions, num_events, minutes, seconds, events_per_sec)
summarize_trap$conditions[[1]] <- "S217A"
summarize_trap$conditions[[2]] <- "WT"
summarize_trap$conditions <- factor(summarize_trap$conditions, levels = c("WT", "S217A"))
summarize_trap
wt_df %>%
filter(forward_index == 0) %>%
pull(n)
mut_df %>%
filter(forward_index == 0) %>%
pull(n)
library(biophysr)
source('~/.active-rstudio-document', echo=TRUE)
files <- list.files("/Users/brentscott/trap_data/project_cardiacAzo/cardiac_ortho_pH7.4/102919",
pattern = "mini_ensemble_events.csv",
recursive = T)
data <- bind_rows(map(files, read_csv))
library(tidyverse)
data <- bind_rows(map(files, read_csv))
files <- list.files("/Users/brentscott/trap_data/project_cardiacAzo/cardiac_ortho_pH7.4/102919",
pattern = "mini_ensemble_events.csv",
recursive = T,
full.names = T)
data <- bind_rows(map(files, read_csv))
View(data)
getwd()
files[[1]]
files <- list.files("/Users/brentscott/trap_data/project_cardiacAzo/cardiac_ortho_pH7.4/102919",
pattern = "mini_ensemble_events.csv",
recursive = T,
full.names = F)
files[[1]]
files <- list.files("/Users/brentscott/trap_data/project_cardiacAzo/cardiac_ortho_pH7.4/102919",
pattern = "mini_ensemble_events.csv",
recursive = T,
full.names = T)
data <- bind_rows(map(files, read_csv))
data <- bind_rows(map(files, read_csv))
View(data)
View(data)
ggplot()+
geom_histogram(data = data, aes(x = displacement_nm))
ggplot()+
geom_histogram(data = data, aes(x = time_on_ms))
View(data)
data %>%
group_by(conditions) %>%
summarize(mean = mean(displacement_nm))
data %>%
group_by(conditions) %>%
summarize(mean = mean(displacement_nm),
sd = sd(displacement_nm))
